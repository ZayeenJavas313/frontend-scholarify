{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}Import Bank Soal dari Excel | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
&rsaquo; <a href="{% url 'admin:quiz_soal_changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
&rsaquo; Import Excel
</div>
{% endblock %}

{% block content %}
<h1>Import Bank Soal dari Excel</h1>

<div style="max-width: 800px; margin: 20px 0;">
    <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 20px; margin-bottom: 20px;">
        <h2 style="margin-top: 0; font-size: 16px; font-weight: 600;">Format File Excel</h2>
        <p style="margin: 10px 0;">File Excel harus memiliki header kolom berikut (baris pertama):</p>
        <table style="width: 100%; border-collapse: collapse; margin: 10px 0;">
            <thead>
                <tr style="background: #e9ecef;">
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">Kode Subtes</th>
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">SOAL</th>
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">A</th>
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">B</th>
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">C</th>
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">D</th>
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">E</th>
                    <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">KUNCI</th>
                </tr>
            </thead>
        </table>
        <p style="margin: 10px 0; font-size: 13px; color: #6c757d;">
            <strong>Catatan:</strong><br>
            • <strong>Kode Subtes</strong>: Harus sesuai dengan kode yang ada di database (LBI, PU, PPU, PBM, PK, LBE, PM)<br>
            • <strong>SOAL</strong>: Teks soal atau bacaan (boleh panjang)<br>
            • <strong>A, B, C, D, E</strong>: Opsi jawaban untuk setiap soal<br>
            • <strong>KUNCI</strong>: Jawaban yang benar (harus huruf A, B, C, D, atau E)
        </p>
    </div>

    <form method="post" enctype="multipart/form-data" style="background: white; border: 1px solid #dee2e6; border-radius: 4px; padding: 20px;">
        {% csrf_token %}
        
        <div style="margin-bottom: 20px;">
            <label for="id_file" style="display: block; margin-bottom: 8px; font-weight: 600;">
                Pilih File Excel (.xlsx atau .xls):
            </label>
            <input 
                type="file" 
                name="file" 
                id="id_file" 
                accept=".xlsx,.xls"
                required
                style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;"
            >
            <p style="margin: 8px 0 0; font-size: 12px; color: #6c757d;">
                Format yang didukung: .xlsx (Excel 2007+) atau .xls (Excel 97-2003)
            </p>
        </div>

        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button 
                type="submit" 
                style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500;"
                onmouseover="this.style.background='#0056b3'"
                onmouseout="this.style.background='#007bff'"
            >
                Import Soal
            </button>
            <a 
                href="{% url 'admin:quiz_soal_changelist' %}" 
                style="background: #6c757d; color: white; text-decoration: none; padding: 10px 20px; border-radius: 4px; display: inline-block; font-size: 14px;"
                onmouseover="this.style.background='#5a6268'"
                onmouseout="this.style.background='#6c757d'"
            >
                Batal
            </a>
        </div>
    </form>

    {% if messages %}
    <div style="margin-top: 20px;">
        {% for message in messages %}
        <div 
            style="padding: 12px; border-radius: 4px; margin-bottom: 10px; {% if message.tags == 'error' %}background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24;{% elif message.tags == 'warning' %}background: #fff3cd; border: 1px solid #ffeaa7; color: #856404;{% else %}background: #d4edda; border: 1px solid #c3e6cb; color: #155724;{% endif %}"
        >
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endblock %}

